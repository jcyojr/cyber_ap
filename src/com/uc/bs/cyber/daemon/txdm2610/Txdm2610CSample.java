/**
 * Sample TEST
 */
package com.uc.bs.cyber.daemon.txdm2610;

import java.io.IOException;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

/*
import com.uc.bs.cyber.service.we532001.We532001FieldList;
import com.uc.bs.cyber.service.we532002.We532002FieldList;
import com.uc.bs.cyber.service.we992001.We992001FieldList;
*/

import com.uc.core.MapForm;
import com.uc.egtob.net.ClientMessageService;
import com.uc.bs.cyber.CbUtil;


import com.uc.bs.cyber.service.kf201001.Kf201001FieldList;
import com.uc.bs.cyber.service.kf201002.Kf201002FieldList;
import com.uc.bs.cyber.service.kf202001.Kf202001FieldList;
import com.uc.bs.cyber.service.kf203001.Kf203001FieldList;

import com.uc.bs.cyber.service.kf251001.Kf251001FieldList;
import com.uc.bs.cyber.service.kf251005.Kf251005FieldList;
import com.uc.bs.cyber.service.kf251002.Kf251002FieldList;
import com.uc.bs.cyber.service.kf252001.Kf252001FieldList;
import com.uc.bs.cyber.service.kf271001.Kf271001FieldList;
import com.uc.bs.cyber.service.kf271002.Kf271002FieldList;
import com.uc.bs.cyber.service.kf272001.Kf272001FieldList;
import com.uc.bs.cyber.service.kf276001.Kf276001FieldList;

import com.uc.bs.cyber.service.bs521001.Bs521001FieldList;
import com.uc.bs.cyber.service.bs521002.Bs521002FieldList;
import com.uc.bs.cyber.service.bs523001.Bs523001FieldList;
import com.uc.bs.cyber.service.bs523002.Bs523002FieldList;
import com.uc.bs.cyber.service.bs992001.Bs992001FieldList;
import com.uc.bs.cyber.service.bs502001.Bs502001FieldList;

import com.uc.bs.cyber.service.kf201001.Kf201001Service;
import com.uc.bs.cyber.service.kf201002.Kf201002Service;
import com.uc.bs.cyber.service.kf202001.Kf202001Service;
import com.uc.bs.cyber.service.kf203001.Kf203001Service;

import com.uc.bs.cyber.service.kf251001.Kf251001Service;
import com.uc.bs.cyber.service.kf251002.Kf251002Service;
import com.uc.bs.cyber.service.kf251005.Kf251005Service;
import com.uc.bs.cyber.service.kf252001.Kf252001Service;

import com.uc.bs.cyber.service.kf271001.Kf271001Service;
import com.uc.bs.cyber.service.kf271002.Kf271002Service;
import com.uc.bs.cyber.service.kf272001.Kf272001Service;
import com.uc.bs.cyber.service.kf276001.Kf276001Service;

import com.uc.bs.cyber.service.bs521001.Bs521001Service;
import com.uc.bs.cyber.service.bs521002.Bs521002Service;
import com.uc.bs.cyber.service.bs523001.Bs523001Service;
import com.uc.bs.cyber.service.bs523002.Bs523002Service;
import com.uc.bs.cyber.service.bs502001.Bs502001Service;
import com.uc.bs.cyber.service.bs992001.Bs992001Service;

import com.uc.bs.cyber.service.bs502101.*;

/**
 * @author 프리비
 *
 */
public class Txdm2610CSample  extends ClientMessageService implements Runnable {

	/**
	 * 
	 * @throws IOException
	 * @throws Exception
	 */

	private int  myId = 0; 
	
	protected Log log = LogFactory.getLog(this.getClass());
	
	private Bs502101FieldList bsField = null;
	
	/**
	 * 
	 * @param hostAddr
	 * @param port
	 * @throws IOException
	 * @throws Exception
	 */
	public Txdm2610CSample() {
		
		CbUtil.setupLog4jConfig(this, "log4j.tomcat.xml");
		
		bsField = new Bs502101FieldList();
	}
		
	public static void main(String[] args) {
		
		int j = 0;
				
		while(true) {
			
			for(int i = 0; i<1; i++) {
				Txdm2610CSample client = new Txdm2610CSample();
				
				client.myId = j++;
				
				Thread thr = new Thread(client);
	
				thr.start();
			}
			
			
			try {
				Thread.sleep(20000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			break;
		
		}		
	}


	
	public void run() {
		// TODO Auto-generated method stub
		
		//We532001FieldList fieldList = new We532001FieldList();
		//We532002FieldList fieldList = new We532002FieldList();
		
		MapForm dataMap = new MapForm();
		
        String sendDa = "";
        
		try {

			Txdm2610CSample client = new Txdm2610CSample();
			client.Connect("127.0.0.1", 51001);       /*결재원 테스트*/
			
			//client.Connect("99.1.1.82", 9383);
			
			/*
			dataMap.setMap("CO_TRAN"      , "532001");
			dataMap.setMap("CO_DT"        , CbUtil.getCurrentTime());
			dataMap.setMap("CO_BKNUM"     , "123456789012");
			dataMap.setMap("CO_AGNUM"     , "123456789012");
			dataMap.setMap("CO_AGCOD"     , "12");
			dataMap.setMap("CO_AGENUM"    , "1234567");
			dataMap.setMap("IH_REGNO"     , "8410251124628");
			dataMap.setMap("EPAY_NO"      , "124124124124124");
			dataMap.setMap("SUM_RCP"      , "125100");
			dataMap.setMap("PAY_DT"       , CbUtil.getCurrentDate());
			dataMap.setMap("BANK_COD"     , "0320007");
			dataMap.setMap("PAY_REG_NO"   , "8410251124628");
			dataMap.setMap("PAY_SYSTEM"   , "1");
			dataMap.setMap("PAY_FORM"     , "1");
			dataMap.setMap("CARD_REQ_NO"  , "909090909090");
			dataMap.setMap("CARD_MMS"     , "01");
			
			client.sendData(fieldList.getBuff(dataMap));

			dataMap.setMap("CO_TRAN"		 , "532002");
			dataMap.setMap("CO_DIV"	     	 , "000");
			dataMap.setMap("CO_DT"     	 	 , CbUtil.getCurrentTime12());
			dataMap.setMap("CO_BKNUM"		 , "032123454554");
			dataMap.setMap("CO_AGNUM"    	 , "000004412555");
			dataMap.setMap("GIRO_COD"        , "71");
			dataMap.setMap("GIRO_NO"         , "1234567");
			dataMap.setMap("REGNO"           , "8410251124628");
			dataMap.setMap("TOTPAY_NO"       , "T12312312312312");
			dataMap.setMap("TOT_CNT"         , "5");
			dataMap.setMap("TOT_SUM_B_AMT"   , "80835680");
			dataMap.setMap("PAY_DT"        	 , CbUtil.getCurrentDate());
			dataMap.setMap("BANK_COD"        , "0321234");
			dataMap.setMap("PAY_REG_NO"      , "8410251124628");
			dataMap.setMap("PAY_SYSTEM"      , "Y");
			dataMap.setMap("PAY_FSYSTEM"     , "Y");
			dataMap.setMap("PAY_FORM"        , "Y");
			dataMap.setMap("CH_INCLUDE"      , "Y");
			dataMap.setMap("CARD_REQ_NO"     , "123456789012");
			dataMap.setMap("CARD_MMS"        , "00");
        */
			
			sendDa = "0855IGN0990200201001000C3111001010703070CT000001490            26100264100731205110971500000100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ";
			
			sendDa = "0488IGN0990200201002000C0001001011045230CT000008510            2610026410026170922090004258            51113021062132617013728102420090921010042582최신옥                                  0000000000683300000000000683303000000000000000000000000068330000000000068330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000201003312010033140586주7675                                                                        20090910N000000000000000000000B14000";
			
			sendDa = "0227IGN0990200202001000C0001001011045520CT000008530            261002641005607191095713      26110921110000943            000000000068330201001010320706                051-465-4070  5607191095713변승섭              SQ          ";
			
			sendDa = "0409IGN0230200251001000B   1105300905130230300008090CT00005453726100410200S000000000000000000001610611006                              00000110 0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000 ";
			
			sendDa = "0210IGN0990200252001000C   1001011229570CT000015577            2610041020026350011036884729             201103000000000018380201001010200402                070-8259-8667 6111262580314홍미숙              SQ         ";
			
			sendDa = "0091IGN0990200271001000C   1105300846080CT000034056            26150017200670707192121500000110";
			
			sendDa = "0784IGN0990200271002000C   1105300708140CT000005598            26150017200E                                2611020863000030070               0000000                                                                                                                                                                                                       0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000           0000000000000000                                                                                                                                                                                                                                                          00000000 000000000000000000000                ";
			
			sendDa = "0239IGN0990200272001000C   1105300708350CT000005655            261500172006707071921215                                2611020863000030070000000000040000201105300320706                051-985-2367  7309262090815김지영              SQ          ";
			
			sendDa = "0091IGN0320200521001000B   1105300705500320I0000010            26100068500540714111011200000110";
			
			sendDa = "0489IGN0320200521002000B   1105300800160320I0000043            26100068500380530140001201105355000390020000054071411101120000000000000000000000000000000                                        00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000                                                                                00000000 000000000000000000000 00000";

			sendDa = "0927IGN0320200523001000B   1105300801070320I0000046            261000685007911151095822201105302011053000000110000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000";
			
			sendDa = "0537IGN0320200523002000B   1105300931480320I0000473            261000685003504301400012011053510004765300000                          0000000000000000000000000000000                                        00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000                                                                                00000000 000000000000000000000000000000000000                          ";
			
			//sendDa = "0156IGN0110420992001000B   11053017141401107876560F0CT002029761261004102000121523             01107824966F110530161338                000000000054560SQ         ";
			sendDa = "0156IGN0480420992001000B   1105300927040480770015530CT000108179261004102000490513             048077001275110530092107                000000000043770SQ         ";
			
			
			//sendDa = "0228IGN0320200502001000B   1106221037550320I0000847            2610006850054071411101120000002301401140022011013730001639400000000000000039410201106220329990                01034578330   6601172120616이진홍    이진홍    B Q         ";
			
			//2611020863000030070
			//6707071921215
			
			sendDa = "0070IGN0990800000301000C   110713143727                        26100068500";
			
			sendDa = "0239IGN0990200272001000C   1107141249200CT000001450            261500172005104201912428                                2614020863000028675000000000055440201107140390008                017-252-1281  7404101921220송동욱              SQ          ";
			
			sendDa = "0380IGN0990200251002000C   1107190925390CT000000103            26100410200E26440011078030329             000000                               00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000                                                            0000000000000000 000000000000000000000          ";
			
			sendDa = "0927IGN0320200523001000B   1107201737390320I0000080            261000685008407051114211201107202011072000000110000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000000000000                             000000000000000000000000000000000000 0000000";
			
			/*실제 real 20110816 */
			
			sendDa = "0091IGN0710200271001000B   1108160022350710D25865C00CT00000014126150017200480918112161600000106";
			
			sendDa = "0135IGN0050200271002000B   1108161142570050EB9876080CT00036913126150017200E                                26350211635000100007802032489711";
			
			sendDa = "0108IGN0110200251002000B   11081613442001109999699F0CT00058660126100410200E26170011078120236             0000001";
			
			sendDa = "0239IGN0990200272001000C   1108181043040CT000250763            261500172006706051109621                                2635020541000092843000000000020000201108180201786                051-529-5876  6706051109621손정호              SQ          ";
			
			sendDa = "0784IGN0990200271002000C   1108181718140CT001111277            26150017200E                                2600028111109538100               0000000                                                                                                                                                                                                       0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000           0000000000000000                                                                                                                                                                                                                                                          00000000 000000000000000000000                ";
			
			sendDa = "0784IGN0990200271002000C   1108221245520CT000800356            26150017200E                                2623021163500004173               0000000                                                                                                                                                                                                       0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000           0000000000000000                                                                                                                                                                                                                                                          00000000 000000000000000000000                ";
			
			sendDa = "0108IGN0200200251002000B   1108251206030200FM0261650CT00080277526100410200S26230011088278979             2011081";
			
			sendDa = "0409IGN0230200251001000B   1108242021140230300130310CT00167806426100410200S000000000000000000001815141000                              00000110 0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000  0000000000000000 00000000 ";
			
			sendDa = "0239IGN0990200272001000C   1108261042500CT000311854            261500172005604081830419                                2614021163500001096000000000032000201108260119328                055-267-6000  5604081830419노학기              EQ          ";
			
			sendDa = "0239IGN0990200272001000C   1108242112450CT001708143            261500172006910101101911                                2600028107104533800000000000050000201108240320706                051-469-5480  6910101101911신종하              SQ          ";
			
			headMap = new MapForm();
			
			/*head*/
			headMap.setMap("LEN"        , "0223");
			headMap.setMap("TX_ID"      , "IGN");
			headMap.setMap("BNK_CODE"   , "032");
			headMap.setMap("TX_GUBUN"   , "0200");
			headMap.setMap("PROGRAM_ID" , "502101");
			headMap.setMap("STS_CODE"   , "000");
			headMap.setMap("RS_FLAG"    , "B");
			headMap.setMap("RESP_CODE"  , " ");
			headMap.setMap("TX_DATE"    , "110627093148");
			headMap.setMap("BCJ_NO"     , "0320I0000473");
			headMap.setMap("GCJ_NO"     , " ");
			headMap.setMap("GPUB_CODE"  , "26");
			headMap.setMap("GJIRO_NO"   , "1000685");
			headMap.setMap("FILLER"     , "00");
			
			/*data*/
			dataMap.setMap("JUMIN_NO"      , "7812301921220");
			dataMap.setMap("JINGSU_ACCTNO" , " ");
			dataMap.setMap("EPAY_NO"       , "2611020641000015817");
			dataMap.setMap("NAPBU_SEQ"     , "000");
			dataMap.setMap("RESERV1"       , " ");
			dataMap.setMap("NAPBU_AMT"     , "3000");
			dataMap.setMap("NAPBU_DATE"    , "20110630");
			dataMap.setMap("OUTBANK_CODE"  , "0321234");
			dataMap.setMap("OUTACCT_NO"    , "123654225664");
			dataMap.setMap("NAP_TELNO"     , "017-252-1281");
			dataMap.setMap("NAPBU_JUMINNO" , "7404101922121");
			dataMap.setMap("NAPBU_NAME"    , "송동욱");
			dataMap.setMap("ACCT_OWNER"    , "송동욱");
			dataMap.setMap("NAPBU_SYS"     , "1");
			dataMap.setMap("B_NAPBU_SYS"   , "1");
			dataMap.setMap("NAPBU_GUBUN"   , "1");
			dataMap.setMap("RESERV2"       , " ");
			dataMap.setMap("RESERV3"       , " ");
			
			long before = System.currentTimeMillis();
			
			sendDa = "0239IGN0990200272001000C   1109170945510CT000051992            261500172006605241567417                                2641021141000062054000000000057260201109170455891                055-381-2599  6605241567417한문택              SQ          ";
			//client.sendData(bsField.makeSendBuffer(headMap, dataMap));
			
			sendDa = "0239IGN0990200272001000C   1109160907370CT000082968            261500172006609031110417                                2641021141000021071000000000022200201109160202617                051-583-2146  6609031110417주기완              EQ          ";
			sendDa = "0239IGN0110200272001000B   11091610281701101102164F0CT0003122862615001720018011106632103370070000020114128808000381400 2647021141000021131000000000072150201109160159155                                                               BQ          ";
			sendDa = "0239IGN0450200272001000B   1109161134540450000136810CT0005126402615001720079081811136193390084000020114128813100066800 2653021141000041934000000000219600201109160455354                 01047736374  7908181113619하만익　　          BQ          ";
			//sendDa = "0239IGN0990200272001000C   1109161500270CT001045842            261500172007211261124011                                2641021141000060596000000000007210201109160455998                010-3353-4742 8307022101718이현정              SQ          ";
			//sendDa = "0239IGN0990200272001000C   1109161951350CT001701954            261500172008004272117821                                2653021141000122229000000000021000201109160754194                055-324-4858  7801201633016최우진              EQ          ";
			
			client.sendData(sendDa.getBytes());
			
			//client.sendData(fieldList.getBuff(dataMap));
			
			//client.sendData("0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              000115992001IGN1102241008230230500000800EP00248284826100068502386076303092037727023010000078110224100821000000000006170S 0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              0001425320011102241014300CT0000017640EP002483032261000685710228196667226470110100420090  000000000021880201102240842828             CQ              ".getBytes());
			
			byte[] recv  = client.recv(30);
			
			long after = System.currentTimeMillis();
			
			log.info("=============================================");
			log.info("  RECV TIME== " + ((after-before)/1000.0) + "Sec ::" +  new String(recv));
			log.info("=============================================");
			
			client.Disconnect();
			
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (Exception e) {
			// TODO Auto-generated catch block
			 e.printStackTrace();
			log.error("=============================================");
			log.error(" RECV 오류발생 ID=" + myId + ", MSG=" + e.getMessage());
			log.error("=============================================");
		}
	}


	/**
	 * @return the myId
	 */
	public int getMyId() {
		return myId;
	}

	/**
	 * @param myId the myId to set
	 */
	public void setMyId(int myId) {
		this.myId = myId;
	}
	
	
}
